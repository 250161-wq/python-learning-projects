"""
Name Analysis System
Created by: Peyman Miyandfashti 250161

A comprehensive system for analyzing and managing names with various operations.
"""

class NameAnalyzer:
    """A class to analyze and process names with multiple functionalities."""
    
    def __init__(self, names_list=None):
        """Initialize with a list of names."""
        self.names = names_list if names_list else []
        self.analysis_results = {}
    
    def add_name(self, name):
        """Add a single name to the list."""
        if name and name not in self.names:
            self.names.append(name)
            return True
        return False
    
    def add_multiple_names(self, *new_names):
        """Add multiple names at once."""
        added_count = 0
        for name in new_names:
            if self.add_name(name):
                added_count += 1
        return added_count
    
    def remove_name(self, name):
        """Remove a name from the list."""
        if name in self.names:
            self.names.remove(name)
            return True
        return False
    
    def analyze_names(self):
        """Comprehensive name analysis using dictionary comprehension."""
        self.analysis_results = {
            'name_lengths': {name: len(name) for name in self.names},
            'uppercase_names': {name: name.upper() for name in self.names},
            'lowercase_names': {name: name.lower() for name in self.names},
            'starts_with_vowel': {name: name[0].lower() in 'aeiou' for name in self.names},
            'name_reversed': {name: name[::-1] for name in self.names}
        }
        return self.analysis_results
    
    def get_statistics(self):
        """Calculate statistics about the names."""
        if not self.analysis_results:
            self.analyze_names()
        
        lengths = list(self.analysis_results['name_lengths'].values())
        
        stats = {
            'total_names': len(self.names),
            'average_length': sum(lengths) / len(lengths) if lengths else 0,
            'longest_name': max(self.analysis_results['name_lengths'].items(), 
                              key=lambda x: x[1]) if self.names else (None, 0),
            'shortest_name': min(self.analysis_results['name_lengths'].items(), 
                               key=lambda x: x[1]) if self.names else (None, 0),
            'vowel_start_count': sum(self.analysis_results['starts_with_vowel'].values())
        }
        return stats
    
    def filter_names(self, min_length=0, max_length=float('inf')):
        """Filter names based on length criteria."""
        filtered = {
            name: length 
            for name, length in self.analysis_results['name_lengths'].items()
            if min_length <= length <= max_length
        }
        return filtered
    
    def export_analysis(self, filename='name_analysis_report.txt'):
        """Export analysis results to a text file."""
        try:
            with open(filename, 'w', encoding='utf-8') as file:
                file.write("NAME ANALYSIS REPORT\n")
                file.write("=" * 50 + "\n")
                file.write(f"Generated by: Peyman Miyandfashti 250161\n")
                file.write(f"Total names analyzed: {len(self.names)}\n\n")
                
                file.write("ORIGINAL NAMES:\n")
                file.write("-" * 20 + "\n")
                for i, name in enumerate(self.names, 1):
                    file.write(f"{i}. {name}\n")
                
                file.write("\nDETAILED ANALYSIS:\n")
                file.write("-" * 20 + "\n")
                
                for analysis_type, results in self.analysis_results.items():
                    file.write(f"\n{analysis_type.upper().replace('_', ' ')}:\n")
                    for name, value in results.items():
                        file.write(f"  {name}: {value}\n")
                
                stats = self.get_statistics()
                file.write("\nSTATISTICS:\n")
                file.write("-" * 15 + "\n")
                for stat, value in stats.items():
                    file.write(f"{stat.replace('_', ' ').title()}: {value}\n")
            
            print(f"Analysis exported successfully to {filename}")
            return True
            
        except Exception as e:
            print(f"Error exporting analysis: {e}")
            return False
    
    def display_results(self):
        """Display all analysis results in a formatted way."""
        print("\n" + "="*60)
        print("NAME ANALYSIS SYSTEM - By Peyman Miyandfashti 250161")
        print("="*60)
        
        print(f"\nOriginal Names: {self.names}")
        
        print("\n ANALYSIS RESULTS:")
        print("-" * 40)
        
        for analysis_type, results in self.analysis_results.items():
            print(f"\n{analysis_type.replace('_', ' ').title()}:")
            for name, value in results.items():
                print(f"  {name:12} â†’ {value}")
        
        # Display statistics
        stats = self.get_statistics()
        print("\nðŸ“ˆ STATISTICS:")
        print("-" * 20)
        for stat, value in stats.items():
            print(f"{stat.replace('_', ' ').title():25}: {value}")


def main():
    """Main function to demonstrate the NameAnalyzer class."""
    
    # Initial data - using your original names
    initial_names = ['Daniel', 'Mike', 'William', 'peyman']
    
    # Create analyzer instance
    analyzer = NameAnalyzer(initial_names)
    
    # Add more names to make it more comprehensive
    new_names_added = analyzer.add_multiple_names('Sarah', 'Mohammad', 'Emma', 'Alexander')
    print(f"Added {new_names_added} new names to the list.")
    
    # Perform comprehensive analysis
    analyzer.analyze_names()
    
    # Display all results
    analyzer.display_results()
    
    # Demonstrate filtering
    print("\n FILTERED NAMES (Length 5-7):")
    print("-" * 35)
    filtered_names = analyzer.filter_names(min_length=5, max_length=7)
    for name, length in filtered_names.items():
        print(f"  {name}: {length} characters")
    
    # Export results to file
    analyzer.export_analysis('my_name_analysis.txt')
    
    # Demonstrate individual operations
    print("\nâœ¨ INDIVIDUAL OPERATIONS:")
    print("-" * 30)
    
    # Remove a name
    removed = analyzer.remove_name('Mike')
    print(f"Removed 'Mike': {removed}")
    
    # Add a new name
    added = analyzer.add_name('Benjamin')
    print(f"Added 'Benjamin': {added}")
    
    # Update analysis after changes
    analyzer.analyze_names()
    
    # Show final results
    print("\n FINAL RESULTS AFTER MODIFICATIONS:")
    analyzer.display_results()


# Additional utility functions
def quick_analysis(names_list):
    """Quick one-time analysis function using dictionary comprehension."""
    print("\n QUICK ANALYSIS:")
    print("-" * 20)
    
    # Multiple dictionary comprehensions for different analyses
    analyses = {
        'Length Analysis': {name: len(name) for name in names_list},
        'Uppercase Version': {name: name.upper() for name in names_list},
        'First Letter': {name: name[0] for name in names_list},
        'Is Long Name (>5 chars)': {name: len(name) > 5 for name in names_list}
    }
    
    for title, results in analyses.items():
        print(f"\n{title}:")
        for name, value in results.items():
            print(f"  {name}: {value}")


if __name__ == "__main__":
    # Run the main demonstration
    main()
    
    # Also demonstrate the quick analysis function
    test_names = ['Daniel', 'Mike', 'William', 'peyman', 'Anna']
    quick_analysis(test_names)
####################################################################################
# Example 1: String length
name = "Peyman"
print(len(name))  # Output: 6

# Example 2: List length
fruits = ["apple", "banana", "cherry"]
print(len(fruits))  # Output: 3

# Example 3: Dictionary length
student = {"name": "John", "age": 20, "grade": "A"}
print(len(student))  # Output: 3
